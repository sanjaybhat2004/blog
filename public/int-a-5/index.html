<!DOCTYPE html>
<html lang="en">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <meta charset="utf-8">

  
  <title>int a = 5;</title>
  
  <link rel="canonical" href="http://example.com/int-a-5/">
  
  <meta name="description" content="In a recent interview, I was asked this question: Consider this line of code: int a &amp;#x3D; 5;   Explain it‚Äôs inner working. To a person like me, who h">
  
  
  <meta name="author" content="John Doe">
  
  
  
  <meta property="og:site_name" content="Hexo" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="int a = 5;" />
  
  <meta property="og:description" content="In a recent interview, I was asked this question: Consider this line of code: int a &amp;#x3D; 5;   Explain it‚Äôs inner working. To a person like me, who h">
  
  <meta property="og:url" content="http://example.com/int-a-5/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="int a = 5;">
  
  <meta name="twitter:description" content="In a recent interview, I was asked this question: Consider this line of code: int a &amp;#x3D; 5;   Explain it‚Äôs inner working. To a person like me, who h">
  
  
  
  
  <meta name="twitter:url" content="http://example.com/int-a-5/" />

  <!-- Mobile Specific Metas
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  <!--  -->

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">üåë</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>‚òÄÔ∏è</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi Folks.
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
        
          
            <a href="mailto:sanjubhat2004@gmail.com" target="_blank" class="ml">Email</a>
          
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>int a = 5;</h2>

  <p>In a recent interview, I was asked this question:</p>
<p>Consider this line of code:</p>
<pre><code>int a &#x3D; 5;</code></pre>


<p>Explain it‚Äôs inner working.</p>
<p>To a person like me, who had prepared to be asked questions on DSA, OOPS, DBMS and OS, seeing a question like this was certainly not in my wildest expectations. Although I was able to give a layman answer on how it would work, after the interview ended it evoked a curiosity in me to explore how the computer actually handles this. The fact that this was a line of code I had probably written thousands of times, yet I had not fully understood what happens under the hood was something I did not like, hence I decided to write this blog to document my learning as well as share it with others.</p>
<p>Alright, we have this line of code. Staring at this line of code even for a day will not lead us to any answer, but the computer does understand what to do when we give this line of code right? Well, before this line of code is given to the computer, it is first converted assembly, so let‚Äôs look at what kind of assembly code we get from it.</p>
<p>Let‚Äôs use the <a target="_blank" rel="noopener" href="https://godbolt.org/">Godbolt</a> compiler explorer for this task.</p>
<!--
![](img1.png)


<!-- ![[Pasted image 20240812181516.png]] -->
<!--
Hmm, interesting. This line of code only translates to one assembly instruction, and we have made no progress into getting our answer either, again getting
another line single of code, which we do not understand the working of.


We know that the current code will not compile due to the absence of main function, what if we put this line inside a main funtion? -->


<!-- %%
Also let us remind ourselves, this is not the only way to create an integer variable, there is one more way by doing the memory allocation at runtime, let us see what it gives. %%


%%  -->
<!-- Ohh, trying to do dynamic memory allocation seems to fail, and  if we dig around deeper, we see that it is a language limitation https://stackoverflow.com/a/3025142. That is okay, since we do not care about its staticness, let us do it inside the main function. %% -->






<!-- ![[Pasted image 20240812185105.png]] -->


<p><img src="/img2.png"></p>
<p>Bam! This small code seems to dump many scary lines of assembly at us, let us go through each of it line by line. First, let us have a small primer on assembly, so that we can try to decode the meaning of the instructions.</p>
<!--
%%
Each assembly instruction is usually one of the following type:
```INS OP1 OP2 OP3``` where ```INS``` specifies the type of instruction being given, and ```OP1, OP2, OP3``` are the operands being operated on. Some instructions may take only one operand, while others may take zero or all three operands too.
%% -->


<p>Each assembly instruction is usually one of the following type<sup><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Addressing_mode">1</a></sup>:</p>
<pre><code>INS
INS DEST
INS DEST, SRC
INS DEST, SRC, EXTRA
</code></pre>
<p>For example, the <code>MOV</code> instruction is of the type 3rd type, where we specify the address of the <code>SRC</code>, and it moves the value present in that address to the address given in <code>DEST</code>. </p>
<p>We also need to have some knowledge about registers. Registers can be basically thought of as variables, which are in predefined memory regions  which are the ‚Äúclosest‚Äù and most easily accessible by the processor. There are many registers available to us, however the only ones that concern us now are EAX, ESP, EBP. Note that whenever write the name of the register, we mean the value in it, however if it is enclosed in <code>[]</code> brackets then we are referencing the value located in that register.</p>
<p>Now what arcane meanings and full forms do these have? Let‚Äôs see.</p>
<p>EAX stands for <strong>E</strong>xtended <strong>A</strong>ccumulator Register.</p>
<p>Extended, indicating that this was a extended 32 bit register instead of the original 16 bit AX register.<br>Accumulator, because it is the primary register used in arithmetic operations.<br>X, because AX itself is a <em>pair</em> of smaller 8 bit registers known as AL and AH.</p>
<!-- %%The other 3 registers in the first 4 registers have similar names too, but in the interest of not over loading with new information and not being able to process the important information, I will not mention them here. Interested people can check it out here: https://stackoverflow.com/questions/892928/why-are-x86-registers-named-the-way-they-are.
%% -->




<p>EBP stands for Extended Base Pointer and ESP stands for Extended Stack Pointer. In the code that we wrote above, we can see registers such as RBP and RSP. In fact EBP and ESP are the 32 bit version of RBP and RSP, and we will use them interchangeably here, since the context is already understood.</p>
<p>We now have encountered one of the big guns in the scene of process memory management, the Stack. The Stack is the one which overflows your non-base-case-handled recursive calls.</p>
<p>The Stack is a data structure, which allows you to add values only at one end, and allows you to remove only the top value (which is at the same end). Imagine a person carrying a ‚Äústack‚Äù of dining plates. He can only add plates at the top (or else it would fall down and make a mess) and he can only remove the plates at the top. The stack in our program also works in a similar way, except for a small quirk that it is actually inverted, in the sense that it grows downward. Downward here means that as the stack grows, the magnitude of the address of the top of stack decreases.</p>
<p>Now that you know what a stack is, let‚Äôs see what EBP and ESP are.</p>
<p>EBP is the pointer which points to the base of the current stack ‚Äúframe‚Äù. A stack frame (which can very in size) can be thought of as a range of addresses on the stack which contains memory space for each function call to store some variables or data, and is no longer valid after the function finishes. The EBP register is also used when we are finding out the addresses of the function arguments, which are located at a fixed offset to it.</p>
<p>ESP is the pointer which points to the top of stack. It is used when we want to push values to the stack.</p>
<p>If you want to know more about assembly level programming, check <a target="_blank" rel="noopener" href="https://www.cs.dartmouth.edu/~sergey/cs258/tiny-guide-to-x86-assembly.pdf">this</a> out.</p>
<p><img src="/img3.png"></p>
<p><img src="/img4.png"></p>
<p>Alright. Now that we know how the stack works, let us go back to the code and understand it line by line.</p>
<ul>
<li><code>push rbp</code>. This line tells to push the current value of the rbp register to the top of the stack. Anytime we need to create a new stack frame, this instruction is performed, in order to save the address of the RBP of the current stack frame. This is required since after the current function call we need to set it back to the previous stack frame‚Äôs base address. This also means that the value of RSP is automatically incremented to point to the new stack top.</li>
</ul>
<p><img src="/img5.png"></p>
<ul>
<li><code>mov rbp, rsp</code> copies the value of RSP register, and puts it into RBP register, so that both of them have the same address. This new address will be the Base pointer for the new stack frame being created for the current function call, which is the <code>int main()</code> function call here.</li>
</ul>
<p><img src="/img6.png"></p>
<ul>
<li><code>mov DWORD PTR [rbp-4], 5</code>: This instruction asks to move the value <code>5</code> to the address given by <code>[rbp-4]</code>. Notice that since the stack grows downward, we need to subtract the address in order to get the address of the next top element of the stack.  The keyword <code>DWORD</code> here tells us that it is a 32 bit data type, (and is also the reason we are subtracting 4, since int is 4 bytes) and <code>QWORD</code> would be used instead, if it was 64 bit.</li>
</ul>
<p><img src="/img7.png"></p>
<ul>
<li><p><code>mov eax, 0</code> another thing you need to know, is that whatever the value the function is returning, must always be in the eax register. Also, during the lifetime of a function, it may change the values of any register, but before it exits, it must set all the other registers except EAX to whatever value they had previously, before the function was called. Since we need to return the value 0, we assign the value 0 to the eax register.</p>
</li>
<li><p><code>ret</code> : this exits the function and sets control flow to the place where the function was called. This destroys the topmost stack frame by undoing the operations that happened in this function call.</p>
</li>
</ul>
<p><img src="/img9.png"></p>
<p>Phew! so much going on behind the scenes in just a single line of code. We may certainly now ask, okay, but what is happening behind the scenes of command <code>mov DWORD PTR [..], 5</code>? For that we will need to go one more layer deeper. But the gist of it is that Assembly Instructions form an almost one-one correspondance with the op codes present on the processor, and the way these op codes are implemented on the processor is by hard coding the logic gates to get the required work done. It is hard to even imagine this, when the even a usual processor nowadays has 10B transistors. The machine code is processed in a fetch decode execute cycles, where the instruction is fetched, decoded and then executed. We will not be going about that in this post.</p>
<p>In order to test your understanding of this concept, try to predict the output of this program.</p>
<p><img src="/img10.png"></p>
<p>I hope that this blog was just as educational and interesting to you as it was to me. See ya around!</p>
<p>Thanks to <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/siddharth-bhat-a0bbb1255/">Siddharth Bhat</a> for proof-reading and providing suggestions for this post.</p>

  <p> ‚Äî Aug 13, 2024</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with ‚ù§ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/sanjaybhat2004" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://www.linkedin.com/in/sanjay-bhat-6b364a250/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="LinkedIn">
        <svg class="linkedin svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
      </a>
      

      

      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>